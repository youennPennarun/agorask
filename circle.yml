machine:
  node:
    version: 6.1.0
  environment:
    MONGO_URL: mongodb://localhost/agorask
dependencies:
  pre: 
    - echo y | android update sdk --no-ui --all --filter tools,build-tools-23.0.1,build-tools-23.0.3,android-23,android-24,extra-google-google_play_services,extra-google-m2repository,extra-android-m2repository,extra-android-support
deployment:
  development:
    branch: development
    commands:
      - git remote add heroku git@heroku.com:agorask-dev.git
      - git subtree push --prefix server heroku master
      - openssl aes-256-cbc -K $encrypted_95f6ce8b3da2_key -iv $encrypted_95f6ce8b3da2_iv -in release.keystore.enc -out mobile_app/android/app/release.keystore -d
      - cd tools/travis/buildApplication && npm install && node deployApplication.js
  production:
    branch: master
    commands:
    commands:
      - git remote add heroku git@heroku.com:agorask.git
      - git subtree push --prefix server heroku master
      - openssl aes-256-cbc -K $encrypted_95f6ce8b3da2_key -iv $encrypted_95f6ce8b3da2_iv -in release.keystore.enc -out mobile_app/android/app/release.keystore -d
      - cd tools/travis/buildApplication && npm install && node deployApplication.js